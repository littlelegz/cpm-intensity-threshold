(()=>{"use strict";var t={8228:function(t,e,r){var n=r(5893),a=r(7294),i=r(745),l=r(4335),s=r(5555),o=r(819),c=r(4640);let d=(0,a.createContext)(),p=t=>{let{children:e}=t,[r,i]=(0,a.useState)(null),[l,s]=(0,a.useState)(null);return(0,n.jsx)(d.Provider,{value:{crosshairValues:r,setCrosshairValues:i,hoverValues:l,setHoverValues:s},children:e})},x=t=>{let{data:e}=t,r=(0,a.useRef)(),i={top:120,right:120,bottom:40,left:40},{crosshairValues:l,setCrosshairValues:p,hoverValues:x,setHoverValues:y}=(0,a.useContext)(d),[h,m]=(0,a.useState)(!1),[u,f]=(0,a.useState)(null),[g,v]=(0,a.useState)(e),j=(0,a.useCallback)((t,e,n)=>{let[a,i]=c.cx$(t),s={cpm:e.xScale.invert(a),intensity:e.yScale.invert(i)};if(h&&l){let t=Math.min(l.cpm,s.cpm),e=Math.max(l.cpm,s.cpm),r=Math.min(l.intensity,s.intensity),n=Math.max(l.intensity,s.intensity);f({cpm:[t,e],intensity:[r,n]}),v(g.filter(a=>a.cpm>=t&&a.cpm<=e&&a.intensity>=r&&a.intensity<=n)),m(!1)}else{let t=c.Ys(r.current),e=t.select(".crosshair"),l=t.select(".reference-crosshair");n(a,i),e.attr("manual-show",!0),e.style("display",null),l.style("display",null),l.select(".reference-vertical").attr("x1",a).attr("x2",a),l.select(".reference-horizontal").attr("y1",i).attr("y2",i),p(s),f(null)}},[h,l,g]);(0,a.useEffect)(()=>{if(!g)return;c.Ys(r.current).selectAll("*").remove();let t=c.Ys("body").append("div").attr("class","tooltip").style("opacity",0),e=c.BYU().domain([c.VV$(g,t=>t.cpm),c.Fp7(g,t=>t.cpm)]).range([i.left,800-i.right]),n=c.BYU().domain([c.VV$(g,t=>t.intensity),c.Fp7(g,t=>t.intensity)]).range([600-i.bottom,i.top]),a=c.Ys(r.current).attr("width",800).attr("height",600),l=c.KXr().value(t=>t.cpm).domain(e.domain()).thresholds(e.ticks(30)),s=c.KXr().value(t=>t.intensity).domain(n.domain()).thresholds(n.ticks(30)),o=l(g),d=s(g),p=c.BYU().domain([0,c.Fp7(o,t=>t.length)]).range([0,i.top]),x=c.BYU().domain([0,c.Fp7(d,t=>t.length)]).range([0,i.right]);a.append("g").attr("transform",`translate(0, ${i.top})`).append("path").datum(o).attr("fill","#999").attr("opacity",.5).attr("d",c.SOn().x(t=>e(t.x0+(t.x1-t.x0)/2)).y0(0).y1(t=>-p(t.length)).curve(c.$0Z)),a.append("g").attr("transform",`translate(${800-i.right}, 0)`).append("path").datum(d).attr("fill","#999").attr("opacity",.5).attr("d",c.SOn().y(t=>n(t.x0+(t.x1-t.x0)/10)).x0(0).x1(t=>x(t.length)).curve(c.$0Z));let h=a.append("g").attr("class","reference-crosshair").style("display","none");h.append("line").attr("class","reference-vertical").attr("y1",i.top).attr("y2",600-i.bottom).attr("stroke","#0066cc").attr("stroke-width",1).attr("stroke-dasharray","3,3"),h.append("line").attr("class","reference-horizontal").attr("x1",i.left).attr("x2",800-i.right).attr("stroke","#0066cc").attr("stroke-width",1).attr("stroke-dasharray","3,3"),a.append("g").attr("transform",`translate(0,${600-i.bottom})`).call(c.LLu(e)).append("text").attr("x",800-i.right).attr("y",-10).attr("fill","black").text("CPM"),a.append("g").attr("transform",`translate(${i.left},0)`).call(c.y4O(n)).append("text").attr("transform","rotate(-90)").attr("y",15).attr("fill","black").text("Intensity");let m=a.append("g").attr("class","crosshair").style("display","none");function u(t,r){if(t>=i.left&&t<=800-i.right&&r>=i.top&&r<=600-i.bottom){m.style("display",null),m.select(".crosshair-vertical").attr("x1",t).attr("x2",t),m.select(".crosshair-horizontal").attr("y1",r).attr("y2",r);let a=e.invert(t).toFixed(2),i=n.invert(r).toFixed(2);m.select(".crosshair-x-label").attr("x",t).text(`CPM: ${a}`),m.select(".crosshair-y-label").attr("y",r).text(`Intensity: ${i}`)}}m.append("line").attr("class","crosshair-vertical").attr("y1",i.top).attr("y2",600-i.bottom).attr("stroke","#666").attr("stroke-width",1).attr("stroke-dasharray","3,3"),m.append("line").attr("class","crosshair-horizontal").attr("x1",i.left).attr("x2",800-i.right).attr("stroke","#666").attr("stroke-width",1).attr("stroke-dasharray","3,3"),m.append("text").attr("class","crosshair-x-label").attr("text-anchor","middle").attr("dy","1em").attr("y",600-i.bottom+20),m.append("text").attr("class","crosshair-y-label").attr("text-anchor","end").attr("dx","-0.5em").attr("x",i.left-5),a.append("rect").attr("width",800-i.left-i.right).attr("height",600-i.top-i.bottom).attr("x",i.left).attr("y",i.top).attr("fill","none").attr("pointer-events","all").on("mousemove",function(t){let[r,a]=c.cx$(t);u(r,a),y({cpm:e.invert(r).toFixed(2),intensity:n.invert(a).toFixed(2)})}).on("mouseleave",function(){m.style("display","none")}).on("click",t=>j(t,{xScale:e,yScale:n},u)),a.selectAll("circle").data(g).join("circle").attr("cx",t=>e(t.cpm)).attr("cy",t=>n(t.intensity)).attr("r",3).attr("fill",t=>1===t.state?"#ff6b6b":"#4ecdc4").attr("opacity",.6).on("mouseover",function(r,a){let i=c.Ys(this);m.attr("manual-show",!0),u(e(a.cpm),n(a.intensity)),i.attr("r",5).attr("stroke","#000").attr("stroke-width",1),t.transition().duration(200).style("opacity",.9),t.html(a.name).style("left",r.pageX+10+"px").style("top",r.pageY-10+"px")}).on("mouseout",function(){let e=c.Ys(this);m.attr("manual-show",null),m.style("display","none"),e.attr("r",3).attr("stroke",null),t.transition().duration(500).style("opacity",0)})},[g]);let b=()=>{if(!l||!e)return;let t=new Blob([["name	state",...e.map(t=>{let e;return e=t.cpm>l.cpm&&t.intensity>l.intensity?1:t.cpm>l.cpm&&t.intensity<=l.intensity?2:t.cpm<=l.cpm&&t.intensity<=l.intensity?3:4,{name:t.name,state:e}}).map(t=>`${t.name}	${t.state}`)].join("\n")],{type:"text/tab-separated-values"}),r=window.URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download="threshold_results.tsv",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)};return(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:l?"space-evenly":"center",alignItems:"center"},children:[(0,n.jsx)("div",{style:{position:"relative"},children:(0,n.jsx)("svg",{ref:r})}),(0,n.jsxs)("div",{className:"rightPanels",style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(()=>{if(!l)return null;let t=(t,n)=>{let a=parseFloat(n);if(!isNaN(a)){p(e=>({...e,[t]:a}));let n=c.Ys(r.current),l=c.BYU().domain([c.VV$(e,t=>t.cpm),c.Fp7(e,t=>t.cpm)]).range([i.left,800-i.right]),s=c.BYU().domain([c.VV$(e,t=>t.intensity),c.Fp7(e,t=>t.intensity)]).range([600-i.bottom,i.top]),o=n.select(".reference-crosshair");"cpm"===t?o.select(".reference-vertical").attr("x1",l(a)).attr("x2",l(a)):o.select(".reference-horizontal").attr("y1",s(a)).attr("y2",s(a))}};var a=0,d=0,x=0,y=0;g.forEach(t=>{t.cpm>l.cpm&&t.intensity>l.intensity?a++:t.cpm<=l.cpm&&t.intensity<=l.intensity?d++:t.cpm>l.cpm&&t.intensity<=l.intensity?x++:t.cpm<=l.cpm&&t.intensity>l.intensity&&y++});let h=(a+d)/(a+d+x+y),m=a/(a+x),u=a/(a+y),f=d/(d+x),v=x/(x+d),j=a/(a+y),k=(a*d-x*y)/Math.sqrt((a+x)*(a+y)*(d+x)*(d+y));return(0,n.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderRadius:"4px",minWidth:"200px"},children:[(0,n.jsx)("div",{style:{display:"flex",justifyContent:"space-evenly",alignItems:"center",marginBottom:"15px"},children:(0,n.jsx)(o.Z,{variant:"h5",children:"Threshold Metrics"})}),(0,n.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,n.jsx)("label",{htmlFor:"cpm-input",children:"CPM:"}),(0,n.jsx)("input",{id:"cpm-input",type:"number",placeholder:l.cpm,onBlur:e=>t("cpm",e.target.value),onKeyUp:e=>{"Enter"===e.key&&t("cpm",e.target.value)},style:{width:"100px",padding:"4px",borderRadius:"4px",border:"1px solid #ccc"}})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,n.jsx)("label",{htmlFor:"intensity-input",children:"Intensity:"}),(0,n.jsx)("input",{id:"intensity-input",type:"number",placeholder:l.intensity,onBlur:e=>t("intensity",e.target.value),onKeyUp:e=>{"Enter"===e.key&&t("intensity",e.target.value)},style:{width:"100px",padding:"4px",borderRadius:"4px",border:"1px solid #ccc"}})]})]}),(0,n.jsxs)("div",{style:{marginTop:"10px"},children:[(0,n.jsxs)("div",{children:["TP: ",a]}),(0,n.jsxs)("div",{children:["TN: ",d]}),(0,n.jsxs)("div",{children:["FP: ",x]}),(0,n.jsxs)("div",{children:["FN: ",y]}),(0,n.jsxs)("div",{children:["Accuracy: ",(100*h).toFixed(2),"%"]}),(0,n.jsxs)("div",{children:["Precision: ",(100*m).toFixed(2),"%"]}),(0,n.jsxs)("div",{children:["Recall: ",(100*u).toFixed(2),"%"]}),(0,n.jsxs)("div",{children:["F1 Score: ",(m*u*2/(m+u)).toFixed(2)]}),(0,n.jsxs)("div",{children:["Specificity: ",(100*f).toFixed(2),"%"]}),(0,n.jsxs)("div",{children:["False Positive Rate: ",(100*v).toFixed(2),"%"]}),(0,n.jsxs)("div",{children:["True Positive Rate: ",(100*j).toFixed(2),"%"]}),(0,n.jsxs)("div",{children:["MCC: ",k.toFixed(2)]})]}),(0,n.jsxs)("div",{style:{marginTop:"10px"},children:[(0,n.jsx)(s.Z,{size:"small",variant:"outlined",color:"error",onClick:()=>{p(null),c.Ys(r.current).select(".reference-crosshair").style("display","none")},children:"Clear"}),(0,n.jsx)(s.Z,{size:"small",variant:"outlined",onClick:b,children:"Download"})]})]})})(),(0,n.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderRadius:"4px",minWidth:"200px"},children:[(0,n.jsx)("div",{className:"graph-main",style:{display:"flex",justifyContent:"space-evenly",alignItems:"center",marginBottom:"15px"},children:(0,n.jsx)(o.Z,{variant:"h5",children:"Zoom Between"})}),(0,n.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,n.jsx)("label",{htmlFor:"cpm-input",children:"CPM:"}),(0,n.jsx)("input",{id:"cpm-input",type:"number",onBlur:t=>handleValueChange("cpm",t.target.value),style:{width:"100px",padding:"4px",borderRadius:"4px",border:"1px solid #ccc"}})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,n.jsx)("label",{htmlFor:"intensity-input",children:"Intensity:"}),(0,n.jsx)("input",{id:"intensity-input",type:"number",onBlur:t=>handleValueChange("intensity",t.target.value),style:{width:"100px",padding:"4px",borderRadius:"4px",border:"1px solid #ccc"}})]})]}),(0,n.jsx)(s.Z,{size:"small",variant:h?"contained":"outlined",color:h?"primary":"default",onClick:()=>{m(!h)},children:h?"Selection Mode Active":"Lock Selection"}),h&&(0,n.jsx)(o.Z,{variant:"caption",color:"textSecondary",style:{marginTop:"8px"},children:"Click second point"}),u&&(0,n.jsx)(s.Z,{size:"small",variant:"outlined",onClick:()=>{v(e),f(null)},style:{marginTop:"8px"},children:"Reset Selection"})]})]})]})},y=t=>{let{data:e}=t,{crosshairValues:r,hoverValues:i}=(0,a.useContext)(d),l=(0,a.useRef)(null),s=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(!e||!r)return;c.Ys(l.current).selectAll("*").remove(),c.Ys(s.current).selectAll("*").remove();let t={top:20,right:20,bottom:30,left:40},n=300-t.left-t.right,a=200-t.top-t.bottom,o=c.Ys(l.current).attr("width",n+t.left+t.right).attr("height",a+t.top+t.bottom).append("g").attr("transform",`translate(${t.left},${t.top})`),d=c.BYU().domain([0,c.Fp7(e,t=>t.cpm)]).range([0,n]),p=c.Ly_().domain(d.domain()).thresholds(40)(e.map(t=>t.cpm)),x=p.map(t=>({x:(t.x0+t.x1)/2,y:e.filter(e=>e.cpm<=t.x0&&e.intensity>=r.intensity).length})),y=p.map(t=>({x:(t.x0+t.x1)/2,y:e.filter(e=>e.cpm>=t.x0&&e.intensity<=r.intensity).length})),h=c.BYU().domain([0,c.Fp7([c.Fp7(x,t=>t.y),c.Fp7(y,t=>t.y)])]).range([a,0]);o.append("path").datum(x).attr("fill","none").attr("stroke","#69b3a2").attr("stroke-width",2).attr("d",c.jvg().x(t=>d(t.x)).y(t=>h(t.y)).curve(c.$0Z)),o.append("path").datum(y).attr("fill","none").attr("stroke","#404080").attr("stroke-width",2).attr("d",c.jvg().x(t=>d(t.x)).y(t=>h(t.y)).curve(c.$0Z)),o.append("g").attr("transform",`translate(0,${a})`).call(c.LLu(d)),o.append("g").call(c.y4O(h));let m=o.append("g").attr("class","hover-line").style("display","none");m.append("line").attr("stroke","#999").attr("stroke-width",1).attr("stroke-dasharray","3,3").attr("y1",0).attr("y2",a);let u=c.Ys(s.current).attr("width",n+t.left+t.right).attr("height",a+t.top+t.bottom).append("g").attr("transform",`translate(${t.left},${t.top})`),f=c.BYU().domain([0,c.Fp7(e,t=>t.intensity)]).range([0,n]),g=c.Ly_().domain(f.domain()).thresholds(40)(e.map(t=>t.intensity)),v=g.map(t=>({x:(t.x0+t.x1)/2,y:e.filter(e=>e.intensity>=t.x0&&e.cpm<=r.cpm).length})),j=g.map(t=>({x:(t.x0+t.x1)/2,y:e.filter(e=>e.intensity<=t.x0&&e.cpm>=r.cpm).length})),b=c.BYU().domain([0,c.Fp7([c.Fp7(v,t=>t.y),c.Fp7(j,t=>t.y)])]).range([a,0]);u.append("path").datum(v).attr("fill","none").attr("stroke","#69b3a2").attr("stroke-width",2).attr("d",c.jvg().x(t=>f(t.x)).y(t=>b(t.y)).curve(c.$0Z)),u.append("path").datum(j).attr("fill","none").attr("stroke","#404080").attr("stroke-width",2).attr("d",c.jvg().x(t=>f(t.x)).y(t=>b(t.y)).curve(c.$0Z)),u.append("g").attr("transform",`translate(0,${a})`).call(c.LLu(f)),u.append("g").call(c.y4O(b));let k=u.append("g").attr("class","hover-line").style("display","none");if(k.append("line").attr("stroke","#999").attr("stroke-width",1).attr("stroke-dasharray","3,3").attr("y1",0).attr("y2",a),i){let t=d(i.cpm);t>=0&&t<=n&&m.style("display",null).select("line").attr("x1",t).attr("x2",t);let e=f(i.intensity);e>=0&&e<=n&&k.style("display",null).select("line").attr("x1",e).attr("x2",e)}},[e,r,i]),(0,n.jsxs)("div",{className:"statGraphs",style:{display:"flex",flexDirection:"row",justifyContent:"space-evenly",marginTop:"20px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{children:"CPM Distribution"}),(0,n.jsx)("svg",{ref:l})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{children:"Intensity Distribution"}),(0,n.jsx)("svg",{ref:s})]})]})};i.createRoot(document.getElementById("root")).render((0,n.jsx)(a.StrictMode,{children:(0,n.jsx)(()=>{let[t,e]=(0,a.useState)(null);return(0,n.jsx)("div",{className:"content",children:(0,n.jsxs)(l.Z,{sx:{p:3},children:[(0,n.jsxs)(l.Z,{sx:{mb:3},children:[(0,n.jsx)("input",{accept:".txt,.tsv",style:{display:"none"},id:"raised-button-file",type:"file",onChange:t=>{let r=t.target.files[0];if(!r)return;let n=new FileReader;n.onload=t=>{let r=t.target.result.split("\n"),n=r[0].split("	"),a=r.slice(1).filter(t=>t.trim()).map(t=>{let e=t.split("	");return n.reduce((t,r,n)=>(t[r]="state"===r?parseInt(e[n]):"cpm"===r||"intensity"===r?parseFloat(e[n]):e[n],t),{})});e(a),console.log("Loaded data:",a.slice(0,5))},n.readAsText(r)}}),(0,n.jsx)("label",{htmlFor:"raised-button-file",children:(0,n.jsx)(s.Z,{variant:"contained",component:"span",children:"Upload Data"})})]}),!t&&(0,n.jsxs)(n.Fragment,{children:["Accepts .txt or .tsv files with the following columns: ",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"name"}),", ",(0,n.jsx)("strong",{children:"cpm"}),", ",(0,n.jsx)("strong",{children:"intensity"}),", ",(0,n.jsx)("strong",{children:"state"}),(0,n.jsx)("br",{})]}),t&&(0,n.jsxs)(p,{children:[(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",flexDirection:"column",gap:"10px",marginBottom:"50px",justifyContent:"space-between"},children:(0,n.jsxs)(o.Z,{children:["Loaded ",t.length," samples"]})}),(0,n.jsx)(x,{data:t}),(0,n.jsx)(y,{data:t})]})]})})},{})}))}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.m=t,(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;r.t=function(n,a){if(1&a&&(n=this(n)),8&a||"object"==typeof n&&n&&(4&a&&n.__esModule||16&a&&"function"==typeof n.then))return n;var i=Object.create(null);r.r(i);var l={};t=t||[null,e({}),e([]),e(e)];for(var s=2&a&&n;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach(t=>{l[t]=()=>n[t]});return l.default=()=>n,r.d(i,l),i}})(),r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t=[];r.O=(e,n,a,i)=>{if(n){i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[n,a,i];return}for(var s=1/0,l=0;l<t.length;l++){for(var[n,a,i]=t[l],o=!0,c=0;c<n.length;c++)(!1&i||s>=i)&&Object.keys(r.O).every(t=>r.O[t](n[c]))?n.splice(c--,1):(o=!1,i<s&&(s=i));if(o){t.splice(l--,1);var d=a();void 0!==d&&(e=d)}}return e}})(),r.rv=()=>"1.3.0",(()=>{var t={980:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var a,i,[l,s,o]=n,c=0;if(l.some(e=>0!==t[e])){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(o)var d=o(r)}for(e&&e(n);c<l.length;c++)i=l[c],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(d)},n=self.webpackChunkvisualization=self.webpackChunkvisualization||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),r.ruid="bundler=rspack@1.3.0";var n=r.O(void 0,["361","813"],function(){return r(8228)});n=r.O(n)})();